# Generated Helm values for {{ .ChartName }}
# This file contains configuration for all apps in the chart

global:
  namespace: {{ .Namespace }}
  environment: {{ .Environment }}
  {{- if .Domain }}
  domain: {{ .Domain }}
  {{- end }}

# OpenTelemetry configuration
otlp:
  endpoint: "http://otel-collector:4317"

# Application configurations
apps:
{{- range .Apps }}
  {{ .Name }}:
    enabled: true
    type: {{ .Type }}
    {{- if .Domain }}
    domain: {{ .Domain }}
    {{- end }}
    image: {{ .Image }}
    imageTag: {{ .ImageTag }}
    {{- if .CommitSha }}
    commitSha: {{ .CommitSha }}
    {{- end }}
    {{- if .Port }}
    port: {{ .Port }}
    {{- end }}
    replicas: {{ .Replicas }}
    {{- if .Command }}
    command: {{ .Command }}
    {{- end }}
    resources:
      requests:
        cpu: {{ .Resources.RequestsCPU }}
        memory: {{ .Resources.RequestsMemory }}
      limits:
        cpu: {{ .Resources.LimitsCPU }}
        memory: {{ .Resources.LimitsMemory }}
    {{- if .Env }}
    env:
      {{- range $key, $value := .Env }}
      {{ $key }}: {{ $value }}
      {{- end }}
    {{- end }}
    {{- if .HealthCheck }}
    healthCheck:
      path: {{ .HealthCheck.Path }}
      initialDelaySeconds: {{ .HealthCheck.InitialDelaySeconds }}
      periodSeconds: {{ .HealthCheck.PeriodSeconds }}
      timeoutSeconds: {{ .HealthCheck.TimeoutSeconds }}
      failureThreshold: {{ .HealthCheck.FailureThreshold }}
    {{- end }}
{{- end }}

{{- if .HasIngress }}
# Ingress defaults (applied to all external-api apps)
# Each external-api gets its own dedicated Ingress resource
ingressDefaults:
  enabled: {{ .IngressEnabled }}
  className: ""
  annotations: {}
{{- end }}
